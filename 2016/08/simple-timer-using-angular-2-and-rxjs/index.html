<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="shortcut icon" href="/favicon.ico">

    <!--Description-->
    
        <meta name="description" content="This is Part 1 for creating a ‘Simple Timer using Angular 2 &amp;amp; RxJS’.DISCLAIMER: My solution may not everybody’s cup of tea. If you have a better a">
    

    <!--Author-->
    
        <meta name="author" content="David Kananda">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Simple Timer using Angular 2 and RxJS - part 1"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="DMKCode"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Simple Timer using Angular 2 and RxJS - part 1 - DMKCode</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-84279485-1', 'auto');
        ga('send', 'pageview');

    </script>



    <script type="text/javascript">
        var host = "dmkcode.com";
        if ((host == window.location.host) && (window.location.protocol != "https:"))
            window.location.protocol = "https";
    </script>

</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/">
            <!-- <i class="logo-icon fa fa-cube" aria-hidden="true"></i> -->
            <img class="logo-icon" src="/img/avatar.png" alt="DMKCode"
        </a>
        
            <h1 id="main-title" class="title">DMKCode</h1>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2016/08/simple-timer-using-angular-2-and-rxjs/">
                Simple Timer using Angular 2 and RxJS - part 1
            </a>
        </h1>
        <div class="post-info">
            <span class="date">15-08-2016</span>
            <a href="#disqus_thread" class="comments">Comments</a>
            <!--
                <span class="category">
                    <a href="/categories/Angular2/">Angular2</a>
                </span>
             -->
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <blockquote><p>This is Part 1 for creating a ‘Simple Timer using Angular 2 &amp; RxJS’.<br><br><br>DISCLAIMER: My solution may not everybody’s cup of tea. If you have a better and more efficient solution, give me shout in the comments, I’m always looking to learn.</p>
</blockquote>
<p>There are many ways to create a timer (counting up) using javascript and in this post, I would like to show you how to implement one as a component using the Angular2 framework and RxJS library. To find out more about Angular2, visit the official documentation <a href="https://angular.io/" target="_blank" rel="external">here</a> and for more RxJS, visit the official documentation <a href="http://reactivex.io/rxjs/" target="_blank" rel="external">here</a>.</p>
<p>The begin with, we will look at the structure of the project and then walk through the steps for how to create the component. Lets begin!</p>
<h2 id="Project-Structure"><a href="#Project-Structure" class="headerlink" title="Project Structure"></a>Project Structure</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── node_modules/</span><br><span class="line">├── package.json</span><br><span class="line">├── src</span><br><span class="line">│   └── app</span><br><span class="line">│       ├── assets/</span><br><span class="line">│       ├── index.html</span><br><span class="line">│       └── scripts</span><br><span class="line">│           ├── bootstrap.ts</span><br><span class="line">│           ├── components/</span><br><span class="line">|           |   ├── app.component.ts</span><br><span class="line">|           |   ├── app.component.html</span><br><span class="line">|           |   └── app.module.ts</span><br><span class="line">│           └── vendor.ts</span><br><span class="line">├── tsconfig.json</span><br><span class="line">├── typings/</span><br><span class="line">├── typings.json</span><br><span class="line">└── webpack</span><br><span class="line">    └── webpack.dev.js</span><br></pre></td></tr></table></figure>
<p>The structure is organised to be as simple as possible. You can find the skeleton for this project structure on my <a href="https://github.com/DMKCode/dmkcode_angular2_webpack_skeleton" target="_blank" rel="external">Github</a>.</p>
<h3 id="Project-Root"><a href="#Project-Root" class="headerlink" title="Project Root"></a>Project Root</h3><p>The project root contains the following files.</p>
<ul>
<li>package.json: contains the list of dependencies and scripts we could run from the command line.</li>
<li>tsconfig.json: contains TypeScript configuration.</li>
<li>typings.json: conatins the TypeScript definition files.</li>
<li>node_modules: directory where the dependencies will reside.</li>
<li>src: directory where the application logic resides. Detailed description is provided below.</li>
<li>webpack: directory where webpack configuration will reside. <a href="https://webpack.github.io/" target="_blank" rel="external">Webpack</a> is the module bundler we will use for this project.</li>
<li>typings: directory where the TypeScript definition files will reside.</li>
</ul>
<h3 id="src-app"><a href="#src-app" class="headerlink" title="src/app"></a>src/app</h3><p>Here is a description of whats contained in the ‘src/app’ directory</p>
<ul>
<li>vendor.ts: contains imports for all vendor specific imports.</li>
<li>bootstrap.ts: used to launch the application by bootstrapping the app module.</li>
<li>index.html: the main html file.</li>
<li>scripts/components/app.component.ts: the app root component.</li>
<li>scripts/components/app.component.html: the template for app root component.</li>
<li>scripts/components/app.module.ts: the app module. Angular provides ‘NgModule’ to help organize an application into cohesive blocks of functionality. Read more <a href="https://angular.io/docs/ts/latest/guide/ngmodule.html" target="_blank" rel="external">here</a>. </li>
</ul>
<h2 id="The-Timer"><a href="#The-Timer" class="headerlink" title="The Timer"></a>The Timer</h2><p>Ok now lets write some code! </p>
<p>Let’s begin by creating an empty file named ‘timer.component.ts’ in ‘src/app/components/‘ directory. This will contain the application logic for the timer.</p>
<p>The following code makes up our timer component.</p>
<script src="//gist.github.com/4ef717db4f7a85c984be93d156226d3c.js?file=timer.component.ts"></script>
<h4 id="whats-going-on"><a href="#whats-going-on" class="headerlink" title="whats going on?"></a>whats going on?</h4><p>At the top we first import ‘Component’ and ‘OnInit’ from ‘angular/core’ and, ‘Observable’ and ‘Subscription’ from ‘rxjs/Rx’.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, OnInit &#125; from <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Observable, Subscription &#125; from <span class="string">'rxjs/Rx'</span>;</span><br></pre></td></tr></table></figure></p>
<blockquote><p>The Component decorator allows you to mark a class as an Angular component and provide additional metadata that determines how the component should be processed, instantiated and used at runtime. – <a href="https://angular.io/docs/ts/latest/api/core/index/Component-decorator.html" target="_blank" rel="external">Angular Doc</a><br><br><br>The <a href="https://angular.io/docs/ts/latest/api/core/index/OnInit-class.html" target="_blank" rel="external">OnInit</a> lifecycle hook provides and ngOnInit() function which is called after all data-bound properties of the component are initialised.<br><br><br>Observable and Subscription are part of the Reactive Extensions for JavaScript (RxJS) which is a reactive streams library which enables us to deal with asynchronous data streams.</p>
</blockquote> 
<p>When then provide component metadata.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Component(&#123;</span><br><span class="line">    selector: <span class="string">'timer'</span>,</span><br><span class="line">    template: <span class="string">` </span><br><span class="line">        &lt;h1&gt;</span><br><span class="line">            &#123;&#123;hoursDisplay ? hoursDisplay : '00'&#125;&#125; : &#123;&#123;(minutesDisplay) &amp;&amp; (minutesDisplay &lt;= 59) ? minutesDisplay : '00'&#125;&#125; : &#123;&#123;(secondsDisplay) &amp;&amp; (secondsDisplay &lt;= 59) ? secondsDisplay : '00'&#125;&#125; &lt;br/&gt;</span><br><span class="line">        &lt;/h1&gt;</span><br><span class="line">    `</span>,</span><br><span class="line">    styles: [ <span class="string">`</span><br><span class="line">        h1 &#123;</span><br><span class="line">            color: #57acec;</span><br><span class="line">            margin-top: 24px; </span><br><span class="line">            text-align: center;   </span><br><span class="line">        &#125;    </span><br><span class="line">    `</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>This essentially means the component will be placed in the html tag with the name ‘timer’.<br>We provide the template as a string, displaying the hours, minutes and seconds. We could also provide this template as a separate file as we did with the app component.<br>And finally, we provide some styles to make the display look a little pretty.</p>
<p>Next up is the actual timer logic.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> TimerComponent <span class="keyword">implements</span> OnInit &#123;</span><br></pre></td></tr></table></figure></p>
<p>We make sure our component implements the OnInit lifecycle hook.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ticks = <span class="number">0</span>;  </span><br><span class="line">minutesDisplay: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">hoursDisplay: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">secondsDisplay: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">sub: Subscription;</span><br><span class="line"><span class="string">``</span><span class="string">` </span><br><span class="line">We then declare our variables to store the values   </span><br><span class="line"></span><br><span class="line">`</span><span class="string">``</span> typeScript</span><br><span class="line">ngOnInit() &#123;</span><br><span class="line">    <span class="keyword">this</span>.startTimer();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We create the function ngOnInit() which will be called when the component is initialised.<br>In this function, we call the startTimer() function explained below.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> startTimer() &#123;</span><br><span class="line">    <span class="keyword">let</span> timer = Observable.timer(<span class="number">1</span>, <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">this</span>.sub = timer.subscribe(</span><br><span class="line">        t =&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>.ticks = t;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">this</span>.secondsDisplay = <span class="keyword">this</span>.getSeconds(<span class="keyword">this</span>.ticks);</span><br><span class="line">            <span class="keyword">this</span>.minutesDisplay = <span class="keyword">this</span>.getMinutes(<span class="keyword">this</span>.ticks);</span><br><span class="line">            <span class="keyword">this</span>.hoursDisplay = <span class="keyword">this</span>.getHours(<span class="keyword">this</span>.ticks);</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In the startTimer() function, we create an observable sequence that produces a value after due time has elapsed and then each period. <a href="https://github.com/Reactive-Extensions/RxJS/blob/master/doc/api/core/operators/timer.md" target="_blank" rel="external">Rx.Observable.timer(dueTime, [period], [scheduler])</a><br>We then subscribe to the observable and every time a value is produced, i.e. ‘t’, we store in the variable ‘ticks’. We then get the seconds, minutes and hours (functions explained below) and store them in the respective variables.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> getSeconds(ticks: <span class="built_in">number</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.pad(ticks % <span class="number">60</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> getMinutes(ticks: <span class="built_in">number</span>) &#123;</span><br><span class="line">    eturn <span class="keyword">this</span>.pad((<span class="built_in">Math</span>.floor(ticks / <span class="number">60</span>)) % <span class="number">60</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> getHours(ticks: <span class="built_in">number</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.pad(<span class="built_in">Math</span>.floor((ticks / <span class="number">60</span>) / <span class="number">60</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> pad(digit: <span class="built_in">any</span>) &#123; </span><br><span class="line">    <span class="keyword">return</span> digit &lt;= <span class="number">9</span> ? <span class="string">'0'</span> + digit : digit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The getSeconds() function simply gets the remainder of the value, i.e. the ticks from the observable, divided by 60. This way the seconds displayed will never exceed 60 as expected. We then append a ‘0’ at the beginning if the value is below 10 by passing the result to the pad function.</p>
<p>The getMinutes() function first divides the value, i.e. the ticks from the observable, by 60 and the gets the remainder of result divided by 60. This way the minutes displayed will never exceed 60 as expected. We then append a ‘0’ at the beginning if the value is below 10 by passing the result to the pad function.</p>
<p>The getHours() function simply divides the value, i.e. the ticks from the observable, divided by 60 twice. We then append a ‘0’ at the beginning if the value is below 10 by passing the result to the pad function.</p>
<p>AND finally, don’t forgot add the timer to ‘app.component.html’<br><figure class="highlight html"><figcaption><span>app.component.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">timer</span>&gt;</span><span class="tag">&lt;/<span class="name">timer</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Run-It"><a href="#Run-It" class="headerlink" title="Run It"></a>Run It</h2><p>To check out the timer in action, just run the command</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install</span><br><span class="line">$ npm run start</span><br></pre></td></tr></table></figure>
<p>Go to <a href="http://localhost:8080" target="_blank" rel="external">http://localhost:8080</a> or <a href="http://localhost:8080/webpack-dev-server/" target="_blank" rel="external">http://localhost:8080/webpack-dev-server/</a> to see the timer!</p>
<img src="/2016/08/simple-timer-using-angular-2-and-rxjs/Simple_TImer_Part1.png" alt="100% simple timer" title="100% simple timer">
<p><br><br>The complete source code can be found on my <a href="https://github.com/DMKCode/timer_angular2_rxjs" target="_blank" rel="external">Github</a>.</p>
<p>In the next part, I will add another component which will start, pause and stop the timer. </p>
<p>Thanks for reading!</p>

    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/Angular2/">#Angular2</a> <a href="/tags/RxJS/">#RxJS</a>
        </div>
    

    <!-- Comments -->
    
    <div class="comments">
        
<div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>



    </div>
    

</div>
        </section>

    </div>
</div>

</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    DMKCode is David Kananda. David Kananda is DMKCode.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2016/10/dockerize-dev-environment/">Dockerizing My Dev Enviro...</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2016/09/simple-timer-using-angular-2-and-rxjs-part-2/">Simple Timer using Angula...</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2016/08/simple-timer-using-angular-2-and-rxjs/">Simple Timer using Angula...</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/Docker/">Docker</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Docker/Node-js/">Node.js</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Docker/Node-js/Express/">Express</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Angular2/">Angular2</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/DMKCode">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://twitter.com/DMKCode">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @DMKCode. All right reserved | Powered by Hexo (Alpha Dust).
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'DMKCode';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>

</html>