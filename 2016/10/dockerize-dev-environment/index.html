<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="shortcut icon" href="/favicon.ico">

    <!--Description-->
    
        <meta name="description" content="DISCLAIMER: My solution may not everybody’s cup of tea. If you have a better and more efficient solution, give me shout in the comments, I’m always lo">
    

    <!--Author-->
    
        <meta name="author" content="David Kananda">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Dockerizing My Dev Environment"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="DMKCode"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Dockerizing My Dev Environment - DMKCode</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-84279485-1', 'auto');
        ga('send', 'pageview');

    </script>



    <script type="text/javascript">
        var host = "dmkcode.com";
        if ((host == window.location.host) && (window.location.protocol != "https:"))
            window.location.protocol = "https";
    </script>

</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/">
            <!-- <i class="logo-icon fa fa-cube" aria-hidden="true"></i> -->
            <img class="logo-icon" src="/img/avatar.png" alt="DMKCode"
        </a>
        
            <h1 id="main-title" class="title">DMKCode</h1>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2016/10/dockerize-dev-environment/">
                Dockerizing My Dev Environment
            </a>
        </h1>
        <div class="post-info">
            <span class="date">01-10-2016</span>
            <a href="#disqus_thread" class="comments">Comments</a>
            <!--
                <span class="category">
                    <a href="/categories/Docker/">Docker</a>
                </span>
             -->
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <blockquote><p>DISCLAIMER: My solution may not everybody’s cup of tea. If you have a better and more efficient solution, give me shout in the comments, I’m always looking to learn.</p>
</blockquote>
<p><a href="https://www.docker.com/" target="_blank" rel="external">Docker</a> is a containerization platform that simplifies building, shipping and running apps.</p>
<p>As a developer, having a consistent environmment removes a lot of the pain associated with having to make sure the computers you use have the same version of software such as frameworks e.g. node. </p>
<p>There many more benefits docker offers and, environment consistency and the ability to have other developers run your app without having to configure the environment (apart from having docker installed) is what this post is about. </p>
<p>I’m going to demonstrate how to dockerize a Node (Express) app for development.</p>
<p>I’m going to assume you have: </p>
<ul>
<li><p>An app generated using <a href="https://expressjs.com/en/starter/generator.html" target="_blank" rel="external">express-generator</a><br>To generate:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install express-generator -g</span><br><span class="line">$ express dockerize_dev_env --hbs</span><br></pre></td></tr></table></figure>
</li>
<li><p>Docker installed on your machine: <a href="https://www.docker.com/products/docker" target="_blank" rel="external">Docker for Mac or Windows</a></p>
</li>
</ul>
<p>With our app ready and running using node on the local machine, we can now change it such that our app should run in a docker container with node and anything else we need for development installed on it. This means that we could run this container with docker on another machine without needing to have node on installed on it.</p>
<h2 id="The-Dockerfile"><a href="#The-Dockerfile" class="headerlink" title="The Dockerfile"></a>The Dockerfile</h2><p>We first create the Dockerfile at the root of the project generated (above).<br>This file is what is used to build the node image for our environment.<br>Read more about the commands used in the file <a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="external">here</a>.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:latest</span><br><span class="line"></span><br><span class="line"><span class="keyword">MAINTAINER</span> DMKCode</span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> NODE_ENV=development </span><br><span class="line"><span class="keyword">ENV</span> PORT=<span class="number">3000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /src</span><br><span class="line"></span><span class="keyword">WORKDIR</span><span class="bash"> /src</span><br><span class="line"></span></span><br><span class="line"><span class="comment"># use nodemon for development</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm install --global nodemon</span><br><span class="line"></span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm install</span><br><span class="line"></span></span><br><span class="line"><span class="comment"># we do this because when we create the container using this image, node_modules from npm install is wiped out as the volume is mounted when creating the container.</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> mv /src/node_modules /node_modules</span><br><span class="line"></span></span><br><span class="line"><span class="keyword">EXPOSE</span> $PORT</span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"npm"</span>, <span class="string">"start"</span>]</span></span><br></pre></td></tr></table></figure>
<p>Essentially what the file does is pull in the latest node image to use as the base image, then sets who the maintainer of the image is i.e. DMKCode.<br>The file then defines two environment variables which will be available to the container created from the image for the app in the container to use.<br>The file then copies the source code from the root folder locally into the image in a folder /src which is also then set as the working directory.<br>The file then installs <a href="https://github.com/remy/nodemon" target="_blank" rel="external">nodemon</a> (watches files and restarts the application if there is a change) globally in the image, then installs the dependencies defined in package.json and then moves the node_modules folder.<br>Finally, the file then specifies the default executing command for the container created from the image.</p>
<p>We then create the <a href="https://docs.docker.com/compose/" target="_blank" rel="external">docker-compose.yml</a> which is particularly useful for multi-container Docker applications. We will use it here for linking the local source to a volume which will be mounted on a container, and naming our container and image without using the command line. </p>
<h2 id="The-docker-compose-yml"><a href="#The-docker-compose-yml" class="headerlink" title="The docker-compose.yml"></a>The docker-compose.yml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"2"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  node_express:</span></span><br><span class="line"><span class="attr">    container_name:</span> node-express</span><br><span class="line"><span class="attr">    image:</span> dmkcode/node-express</span><br><span class="line"><span class="attr">    build:</span> </span><br><span class="line"><span class="attr">      context:</span> .</span><br><span class="line"><span class="attr">    command:</span> nodemon --debug=<span class="number">5858</span></span><br><span class="line"><span class="attr">    volumes:</span></span><br><span class="line"><span class="bullet">      -</span> .:/src</span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"8000:3000"</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"5858:5858"</span></span><br></pre></td></tr></table></figure>
<p>The file defines a service called node_express from the image built from the Dockerfile in the current directory.<br>The file, for develpment overrides the command specified in the Dockerfile which enables remote debugging provided by node. However, the image on its own will not have this enabled which is suitable for production. For more about live debugging, check out the <a href="https://blog.docker.com/2016/07/live-debugging-docker/" target="_blank" rel="external">blog</a> by <a href="https://blog.docker.com/author/aanand/" target="_blank" rel="external">Aanand Prasad</a>.<br>The file then mounts the current directory as a volume /src overwriting anything in it. This means the image will not have to be rebuilt every time there is a change to the source code.<br>The file then maps port 3000 in the container to port 8000 externally i.e. machine localhost and port 5858 in the container to port 5858 externally i.e. machine localhost for connecting to the remote debugger.</p>
<h2 id="Run-It"><a href="#Run-It" class="headerlink" title="Run It"></a>Run It</h2><p>Check out the app by running: </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose build</span><br><span class="line">$ docker-compose up</span><br></pre></td></tr></table></figure>
<p>Go to <a href="http://localhost:8000" target="_blank" rel="external">http://localhost:8000</a> to see the app!</p>
<img src="/2016/10/dockerize-dev-environment/node_express.png" alt="100% node app" title="100% node app">
<p><br><br>If you were to make changes to the source code, the app in the container will be automatically restarted by nodemon meaning no need to rebuild the image. </p>
<p>The complete source code can be found on my <a href="https://github.com/DMKCode/dockerize_dev_env" target="_blank" rel="external">Github</a>. </p>
<p>Thanks for reading!</p>

    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/Docker/">#Docker</a> <a href="/tags/Node-js/">#Node.js</a> <a href="/tags/Express/">#Express</a>
        </div>
    

    <!-- Comments -->
    
    <div class="comments">
        
<div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>



    </div>
    

</div>
        </section>

    </div>
</div>

</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    DMKCode is David Kananda. David Kananda is DMKCode.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2016/10/dockerize-dev-environment/">Dockerizing My Dev Enviro...</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2016/09/simple-timer-using-angular-2-and-rxjs-part-2/">Simple Timer using Angula...</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2016/08/simple-timer-using-angular-2-and-rxjs/">Simple Timer using Angula...</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/Docker/">Docker</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Docker/Node-js/">Node.js</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Docker/Node-js/Express/">Express</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Angular2/">Angular2</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/DMKCode">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://twitter.com/DMKCode">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @DMKCode. All right reserved | Powered by Hexo (Alpha Dust).
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'DMKCode';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>

</html>